# Load Average 및 시스템 부하 관리

**Load Average**는 리눅스 시스템의 CPU와 디스크 I/O 부하를 나타내는 지표로, 1분, 5분, 15분의 평균값으로 표현됩니다. 이는 시스템에 얼마나 많은 활성 프로세스가 있는지를 보여줍니다.

## 1. 정의
Load Average는 단위 시간 동안 실행 가능 또는 중단 불가능한 상태의 프로세스 평균 수를 의미하며, CPU 사용률과는 직접적으로 연관이 없습니다.

## 2. 프로세스 상태
- **실행 가능한 프로세스**: CPU를 사용 중이거나 기다리는 프로세스.
- **중단 불가능 프로세스**: 중요한 커널 프로세스 등.

## 3. Load Average 해석
- Load Average가 1이면, CPU 코어 1개가 100% 사용 중임을 의미합니다.
- Load Average가 4라면, CPU 코어 4개가 100% 사용 중이거나, CPU 코어 1개가 400% 사용 중일 수 있습니다.

## 4. 부하 관리
- Load Average가 지속적으로 높다면, 시스템 성능을 향상시키기 위해 리소스 추가 또는 프로세스 최적화가 필요합니다.
- 부하가 높은 프로세스를 찾아 중지하거나, 하드웨어 리소스를 추가하는 등의 대응 방법을 고려할 수 있습니다.

이러한 이해를 바탕으로 Load Average를 통해 시스템의 부하를 효과적으로 관리할 수 있습니다.

---

## Load Average 및 시스템 부하 관리

**Load Average**는 활성 프로세스의 평균 수를 나타내며, 이를 통해 시스템 부하를 평가할 수 있습니다. 평균 부하 값이 2일 때의 의미는 다음과 같습니다:

- **CPU 2개**: 모든 CPU가 완전히 사용 중임.
- **CPU 4개**: 50%의 유휴 CPU 용량이 존재.
- **CPU 1개**: 프로세스의 절반이 CPU 시간을 놓고 경쟁 중임.

### 부하 평가

부하를 평가할 때 가장 먼저 알아야 할 점은 시스템의 CPU 개수입니다. 이를 위해 `top` 명령이나 `/proc/cpuinfo` 파일을 확인할 수 있습니다. 평균 부하가 CPU 개수를 초과할 경우 시스템은 과부하 상태임을 알 수 있습니다.

1. **부하 안정성**:
   - 1분, 5분, 15분의 Load Average 값이 유사하면 시스템 부하가 안정적임을 나타냅니다.
   - 1분 값이 15분 값보다 훨씬 낮다면, 최근 1분 동안 부하가 감소한 것을 의미하며, 반대로 높다면 최근 부하가 증가한 것입니다. 이 경우, 지속적인 관찰이 필요합니다.

2. **과부하 확인**:
   - 1분 평균 부하가 CPU 수에 근접하거나 초과할 경우, 과부하 상태임을 나타냅니다. 이럴 때는 원인을 분석하고 최적화를 고려해야 합니다.

### 평균 부하 vs CPU 사용률

**평균 부하**는 활성 프로세스 수를 나타내지만, CPU 사용률과 혼동할 수 있습니다. 평균 부하는 실행 가능하거나 I/O를 기다리는 프로세스 수를 포함합니다. 반면, CPU 사용률은 CPU가 얼마나 바쁜지를 나타내는 통계로, 반드시 평균 부하와 일치하지 않습니다.

부하 증가의 근본 원인을 파악하기 위해 `iostat`, `mpstat`, `pidstat` 등의 도구를 사용할 수 있습니다.

### 예시 환경

- **기본 시스템**: Ubuntu 18.04
- **하드웨어 구성**: CPU 2개, RAM 8GB
- **필요 패키지**: `stress`, `sysstat` (설치 명령: `apt install stress sysstat`)

이러한 도구와 정보를 통해 Load Average를 효과적으로 모니터링하고 시스템 성능을 최적화할 수 있습니다.

## stress 테스트 도구 및 성능 모니터링

**stress**는 비정상적인 프로세스로 인해 평균 부하가 증가하는 시나리오를 시뮬레이션하기 위해 사용되는 Linux 시스템 stress 테스트 도구입니다.

### sysstat 패키지

**sysstat**에는 시스템 성능을 모니터링하고 분석하는 데 일반적으로 사용되는 여러 Linux 성능 도구가 포함되어 있습니다. 이 패키지의 두 가지 주요 명령어는 다음과 같습니다:

- **mpstat**: 멀티코어 CPU 성능을 분석하는 데 사용됩니다. 각 CPU에 대한 실시간 성능 지표와 모든 CPU에 대한 평균 지표를 확인
- **pidstat**: 프로세스 성능을 분석하는 도구로, 각 프로세스의 CPU, 메모리, I/O, 컨텍스트 전환에 대한 실시간 성능 지표를 제공

### 테스트 준비

각 시나리오에서는 다음과 같은 준비가 필요합니다:

1. 세 개의 터미널을 열고 동일한 Linux 머신에 로그인합니다.
2. 루트 사용자로 전환합니다.
3. `uptime` 명령을 사용하여 테스트 시작 전 평균 부하를 확인합니다.


markdown
코드 복사
### 시스템 부하 확인

테스트 시작 전에 평균 부하를 확인하기 위해 다음 명령을 사용합니다:

```bash
$ uptime
..., 부하 평균: 0.11, 0.15, 0.09
```







