# β™οΈ λ¦¬λ…μ¤ μ‹μ¤ν…μ ν‰κ·  λ¶€ν• μ΄ν•΄ λ° μ‹¤μµ

## π’΅ κ°μ”

μ΄ ν”„λ΅μ νΈλ” "Deep Understanding of Average Load in Linux" λΈ”λ΅κ·Έ ν¬μ¤νΈλ¥Ό μ°Έκ³ ν•μ—¬, λ¦¬λ…μ¤ μ‹μ¤ν…μ ν‰κ·  λ¶€ν•(Average Load)λ¥Ό μ΄ν•΄ν•κ³  ν…μ¤νΈν•λ” λ°©λ²•μ„ λ‹¤λ£Ήλ‹λ‹¤.

μ„λ²„ λ¶€ν• ν…μ¤νΈλ¥Ό ν†µν•΄ μμƒλλ” νΈλν”½μ΄λ‚ μ‘μ—…λ‰μ„ μ„λ²„κ°€ μ¶©λ¶„ν μ²λ¦¬ν•  μ μλ”μ§€ μ‚¬μ „μ— ν™•μΈν•κ³ , μ‹¤μ  μ΄μ μ¤‘ λ°μƒν•  μ μλ” λ¬Έμ λ¥Ό μλ°©ν•λ ¤κ³  ν–μµλ‹λ‹¤.

λν•, ν‰κ·  λ¶€ν•λ¥Ό λ¨λ‹ν„°λ§ν•κ³  λ¶„μ„ν•  μ μλ” μ‹¤μµ μμ λ¥Ό ν¬ν•¨ν•κ³  μμ–΄, μ‹μ¤ν… κ΄€λ¦¬μ™€ ν™•μ¥ κ³„ν μλ¦½μ— μ μ©ν• μλ£κ°€ λ  κ²ƒμ…λ‹λ‹¤.

## π” νƒκµ¬ μΈμ›

| <img src="https://avatars.githubusercontent.com/u/65701100?v=4" width="150" height="150"/> | <img src="https://avatars.githubusercontent.com/u/86272865?v=4" width="150" height="150"/> |
| :----------------------------------------------------------------------------------------: | :----------------------------------------------------------------------------------------: |
|              **ν™λ―Όμ** <br/>[@HongMinYeong](https://github.com/HongMinYeong)              |                  **μµμμ—°**<br/>[@lotuxsoo](https://github.com/lotuxsoo)                   |

---

λ¦¬λ…μ¤ μ‹μ¤ν…μ μ„±λ¥μ„ λ¨λ‹ν„°λ§ν•  λ• `uptime` λ…λ Ήμ–΄λ¥Ό ν†µν•΄ ν‘μ‹λλ” "ν‰κ·  λ¶€ν•(Average Load)"λ” λ§¤μ° μ¤‘μ”ν• μ§€ν‘μ…λ‹λ‹¤. ν‰κ·  λ¶€ν•λ” λ‹¨μ„ μ‹κ°„(1λ¶„, 5λ¶„, 15λ¶„) λ™μ• CPUκ°€ μ²λ¦¬ν•΄μ•Ό ν•λ” ν™μ„± ν”„λ΅μ„Έμ¤μ ν‰κ·  μλ¥Ό λ‚νƒ€λƒ…λ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ μ‹μ¤ν…μ μƒνƒλ¥Ό νμ•…ν•κ³ , ν•„μ”ν• κ²½μ° μ„±λ¥ κ°μ„  μ΅°μΉλ¥Ό μ·¨ν•  μ μμµλ‹λ‹¤.

## 1. ν‰κ·  λ¶€ν•(Average Load)λ€?

ν‰κ·  λ¶€ν•(Average Load)λ” λ‹¨μ„ μ‹κ°„ λ™μ• CPUμ—μ„ μ²λ¦¬ μ¤‘μ΄κ±°λ‚ μ²λ¦¬ λ€κΈ° μ¤‘μΈ ν”„λ΅μ„Έμ¤μ ν‰κ·  μλ¥Ό μλ―Έν•©λ‹λ‹¤. μ΄λ” CPU μ‚¬μ©λ¥ κ³Όλ” μ§μ ‘μ μΌλ΅ μ—°κ΄€λμ§€ μ•μΌλ©°, μ‹μ¤ν…μ μ „μ²΄μ μΈ λ¶€ν• μƒνƒλ¥Ό ν‰κ°€ν•λ” μ§€ν‘λ΅ μ‚¬μ©λ©λ‹λ‹¤.

- **CPU κ°μμ™€ λΉ„κµ**: ν‰κ·  λ¶€ν• κ°’μ΄ μ‹μ¤ν…μ CPU κ°μμ™€ λΉ„μ·ν•λ©΄ μ •μƒμ μΈ μƒνƒμ΄λ©°, μ΄λ¥Ό μ΄κ³Όν•λ©΄ μ‹μ¤ν…μ΄ κ³Όλ¶€ν• μƒνƒμ„μ„ μλ―Έν•©λ‹λ‹¤.

μλ¥Ό λ“¤μ–΄, ν‰κ·  λ¶€ν• κ°’μ΄ 2μΌ λ•μ μλ―Έλ” λ‹¤μκ³Ό κ°™μµλ‹λ‹¤.

- **CPU 2κ°**: λ¨λ“  CPUκ°€ μ™„μ „ν μ‚¬μ© μ¤‘μ„μ„ μλ―Έν•©λ‹λ‹¤.
- **CPU 4κ°**: 50%μ μ ν΄ CPU μ©λ‰μ΄ μ΅΄μ¬ν•©λ‹λ‹¤.
- **CPU 1κ°**: ν”„λ΅μ„Έμ¤μ μ λ°μ΄ CPU μ‹κ°„μ„ λ†“κ³  κ²½μ μ¤‘μ„μ„ μλ―Έν•©λ‹λ‹¤.

## 2. ν‰κ·  λ¶€ν• ν•΄μ„

- **λ¶€ν• μ•μ •μ„±**: 1λ¶„, 5λ¶„, 15λ¶„μ ν‰κ·  λ¶€ν• κ°’μ΄ μ μ‚¬ν•λ©΄ μ‹μ¤ν… λ¶€ν•κ°€ μ•μ •μ μ„μ„ λ‚νƒ€λƒ…λ‹λ‹¤.
- **λ¶€ν• λ³€ν™”**: 1λ¶„ κ°’μ΄ 15λ¶„ κ°’λ³΄λ‹¤ ν›¨μ”¬ λ‚®λ‹¤λ©΄, μµκ·Ό λ¶€ν•κ°€ κ°μ†ν• κ²ƒμ΄λ©°, λ°λ€λ΅ λ†’λ‹¤λ©΄ μµκ·Ό λ¶€ν•κ°€ μ¦κ°€ν• κ²ƒμ…λ‹λ‹¤.
- **κ³Όλ¶€ν• ν™•μΈ**: 1λ¶„ ν‰κ·  λ¶€ν•κ°€ CPU μμ— κ·Όμ ‘ν•κ±°λ‚ μ΄κ³Όν•  κ²½μ° κ³Όλ¶€ν• μƒνƒλ¥Ό μλ―Έν•λ©°, μ΄λ•λ” μ›μΈ λ¶„μ„ λ° μµμ ν™”κ°€ ν•„μ”ν•©λ‹λ‹¤.

## 3. μ‹¤μµ: λ¦¬λ…μ¤ μ‹μ¤ν…μ ν‰κ·  λ¶€ν• ν…μ¤νΈ

### 1. μ‹¤μµ μ¤€λΉ„

μ‹¤μµμ„ μ„ν•΄ ν•„μ”ν• ν¨ν‚¤μ§€λ¥Ό μ„¤μΉν•©λ‹λ‹¤.

```bash
sudo apt-get install stress sysstat
```

### 2. ν„μ¬ μ‹μ¤ν… μƒνƒ ν™•μΈ

λ¨Όμ €, ν„μ¬ μ‹μ¤ν…μ ν‰κ·  λ¶€ν•μ™€ CPU κ°μλ¥Ό ν™•μΈν•©λ‹λ‹¤.

```bash
uptime
grep 'model name' /proc/cpuinfo | wc -l
```

### 3. CPU λ° I/O λ¶€ν• ν…μ¤νΈ

CPUμ™€ I/Oμ— λ¶€ν•λ¥Ό μ£Όλ©΄μ„ ν‰κ·  λ¶€ν•κ°€ μ–΄λ–»κ² λ³€ν™”ν•λ”μ§€ ν™•μΈν•©λ‹λ‹¤.

#### **CPU λ¶€ν• ν…μ¤νΈ**

CPUμ— λ¶€ν•λ¥Ό μ£Όκ³ , ν‰κ·  λ¶€ν•κ°€ μ–΄λ–»κ² λ³€ν™”ν•λ”μ§€ κ΄€μ°°ν•©λ‹λ‹¤.

```bash
stress --cpu 2 --timeout 60
watch -n 1 uptime
```

- 2κ°μ CPUλ¥Ό 60μ΄ λ™μ• 100% μ‚¬μ©ν•λ„λ΅ λ¶€ν•λ¥Ό μ¤λ‹λ‹¤.
- ν‰κ·  λ¶€ν• λ¨λ‹ν„°λ§: μ‹¤μ‹κ°„μΌλ΅ ν‰κ·  λ¶€ν•λ¥Ό ν™•μΈν•©λ‹λ‹¤.

#### **I/O λ¶€ν• ν…μ¤νΈ**

I/O μ‘μ—…μ„ ν†µν•΄ λ””μ¤ν¬μ— λ¶€ν•λ¥Ό μ£Όκ³ , ν‰κ·  λ¶€ν•μ λ³€ν™”λ¥Ό ν™•μΈν•©λ‹λ‹¤.

```bash
stress --io 4 --timeout 60
watch -n 1 uptime
```

- I/O μ‘μ—…μ„ ν†µν•΄ λ””μ¤ν¬μ— λ¶€ν•λ¥Ό μ¤λ‹λ‹¤.
- ν‰κ·  λ¶€ν• λ¨λ‹ν„°λ§: μ‹¤μ‹κ°„μΌλ΅ ν‰κ·  λ¶€ν•μ™€ I/O λ€κΈ° μ‹κ°„μ„ ν™•μΈν•©λ‹λ‹¤.

### 4. μ‹¤μ‹κ°„ μ„±λ¥ λ¶„μ„

`mpstat`μ™€ `pidstat`λ¥Ό μ‚¬μ©ν•μ—¬ CPU μ‚¬μ©λ¥ κ³Ό ν”„λ΅μ„Έμ¤ μ„±λ¥μ„ μ‹¤μ‹κ°„μΌλ΅ λ¶„μ„ν•©λ‹λ‹¤.

```bash
mpstat -P ALL 1
pidstat -u 1
```

### 5. μλ™ν™” ν…μ¤νΈ μ¤ν¬λ¦½νΈ μ‘μ„±

λ¶€ν• ν…μ¤νΈ κ³Όμ •μ„ μλ™ν™”ν•κΈ° μ„ν• κ°„λ‹¨ν• Bash μ¤ν¬λ¦½νΈλ¥Ό μ‘μ„±ν•  μ μμµλ‹λ‹¤.

```bash
#!/bin/bash

echo "Starting CPU load test..."
stress --cpu 2 --timeout 60 &

echo "Monitoring load average..."
watch -n 1 uptime &

sleep 60

echo "Starting I/O load test..."
stress --io 4 --timeout 60 &

sleep 60

echo "Monitoring CPU and process performance..."
mpstat -P ALL 1 &
pidstat -u 1
```

μ΄ μ¤ν¬λ¦½νΈλ¥Ό μ‹¤ν–‰ν•λ©΄ ν‰κ·  λ¶€ν•κ°€ μ‹¤μ‹κ°„μΌλ΅ μ–΄λ–»κ² λ³€ν™”ν•λ”μ§€ ν•λμ— ν™•μΈν•  μ μμµλ‹λ‹¤.
